# Story 0.13: Validate PostgreSQL MCP Connection

## Status
Ready for development

## Story
**As a** Developer,
**I want** PostgreSQL MCP connection validated and documented,
**so that** I can use MCP tools for database operations throughout development.

## Acceptance Criteria
1. PostgreSQL MCP server connects to studymate_user database
2. CRUD operations verified through MCP (SELECT, INSERT, UPDATE, DELETE)
3. Schema queries work through MCP
4. MCP connection documented for team use
5. Test queries created as reference examples
6. MCP integration verified in story workflow

## Tasks / Subtasks
- [ ] Task 1: Test MCP connection (AC: 1)
  - [ ] Use mcp__postgres__query tool to connect
  - [ ] Run SELECT version(); to verify connection
  - [ ] Verify database name is studymate_user
  - [ ] Check connection credentials work
- [ ] Task 2: Test SELECT queries (AC: 2)
  - [ ] Query users table: SELECT * FROM users;
  - [ ] Query study_halls table
  - [ ] Query with JOIN across tables
  - [ ] Test WHERE clauses and filtering
- [ ] Task 3: Test INSERT operations (AC: 2)
  - [ ] Insert test user into users table
  - [ ] Insert test study hall
  - [ ] Verify data inserted correctly
  - [ ] Clean up test data
- [ ] Task 4: Test UPDATE operations (AC: 2)
  - [ ] Update test record
  - [ ] Verify changes applied
  - [ ] Test UPDATE with WHERE clause
- [ ] Task 5: Test DELETE operations (AC: 2)
  - [ ] Delete test record
  - [ ] Verify deletion
  - [ ] Test DELETE with WHERE clause
  - [ ] Test CASCADE behavior with foreign keys
- [ ] Task 6: Test schema queries (AC: 3)
  - [ ] List all tables
  - [ ] Describe table structure
  - [ ] Query constraints and indexes
  - [ ] Check foreign key relationships
- [ ] Task 7: Create reference query examples (AC: 5)
  - [ ] Document common queries in docs/postgres-mcp-examples.md
  - [ ] Include CRUD examples
  - [ ] Add schema inspection queries
  - [ ] Add performance queries (EXPLAIN)
- [ ] Task 8: Document MCP usage (AC: 4)
  - [ ] Add MCP section to README
  - [ ] Document connection parameters
  - [ ] Add troubleshooting tips
  - [ ] Document best practices for MCP database operations

## Dev Notes

### Previous Story Insights
**From Story 0.10:** PostgreSQL installed with studymate_user database
**From Story 0.12:** Initial schema created with 4 core tables

### PostgreSQL MCP Configuration
[Source: docs/architecture/studymate-system-architecture-blueprint.md#7-postgresql-mcp-integration-mandatory]
- **Database**: studymate_user
- **Username**: studymate_user
- **Password**: studymate_user
- **Host**: localhost
- **Port**: 5432

### MCP Test Queries

**Connection Test:**
```sql
SELECT version();
SELECT current_database();
```

**CRUD Examples:**
```sql
-- INSERT
INSERT INTO users (email, password_hash, first_name, role)
VALUES ('test@example.com', 'hash123', 'Test', 'OWNER');

-- SELECT
SELECT * FROM users WHERE email = 'test@example.com';

-- UPDATE
UPDATE users SET first_name = 'Updated' WHERE email = 'test@example.com';

-- DELETE
DELETE FROM users WHERE email = 'test@example.com';
```

**Schema Inspection:**
```sql
-- List tables
SELECT table_name FROM information_schema.tables WHERE table_schema = 'public';

-- Describe table
SELECT column_name, data_type, is_nullable
FROM information_schema.columns
WHERE table_name = 'users';

-- Check constraints
SELECT constraint_name, constraint_type
FROM information_schema.table_constraints
WHERE table_name = 'users';
```

### Mandatory Usage Scenarios
[Source: docs/architecture/studymate-system-architecture-blueprint.md#7-postgresql-mcp-integration-mandatory]
- Schema validation
- Migration testing
- Data verification
- CRUD testing
- Constraint testing
- Performance testing

### File Location
- Documentation: `docs/postgres-mcp-examples.md`

## Testing
- **Connection**: MCP connects successfully
- **CRUD**: All operations work via MCP
- **Schema**: Can inspect database structure
- **Validation**: Every AC validated via MCP

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-10 | 1.0 | Story created from Epic 0, Feature 0.3 | Bob (Scrum Master) |

## Dev Agent Record
_To be filled by Dev Agent_

## QA Results
_To be filled by QA Agent_
