# Story 0.21: Create JWT Token Service

## Status
Ready for development

## Story
**As a** Developer,
**I want** a JWT token service for token generation and validation,
**so that** authentication tokens can be created and verified.

## Acceptance Criteria
1. JwtTokenService created with generate method
2. Token validation method implemented
3. Claims extraction methods implemented
4. Token expiration handling implemented
5. Service unit tested thoroughly
6. Service integrated with Spring Security

## Tasks / Subtasks
- [ ] Create JwtTokenService class (AC: 1)
  - [ ] Inject JwtConfig for secret and expiration
  - [ ] Implement generateToken(UserDetails)
  - [ ] Add user details to claims
  - [ ] Set expiration date
- [ ] Implement validation (AC: 2)
  - [ ] Create validateToken method
  - [ ] Check expiration
  - [ ] Verify signature
  - [ ] Handle exceptions
- [ ] Implement claims extraction (AC: 3)
  - [ ] extractUsername method
  - [ ] extractRoles method
  - [ ] extractExpiration method
  - [ ] Generic extractClaim method
- [ ] Handle token expiration (AC: 4)
  - [ ] Check if token expired
  - [ ] Return appropriate error
  - [ ] Log expiration events
- [ ] Create unit tests (AC: 5)
  - [ ] Test token generation
  - [ ] Test validation with valid token
  - [ ] Test validation with expired token
  - [ ] Test validation with invalid signature
  - [ ] Test claims extraction

## Dev Notes
Uses JJWT library for JWT operations.

### Dependencies
Add to pom.xml:
```xml
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-api</artifactId>
    <version>0.12.3</version>
</dependency>
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-impl</artifactId>
    <version>0.12.3</version>
    <scope>runtime</scope>
</dependency>
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt-jackson</artifactId>
    <version>0.12.3</version>
    <scope>runtime</scope>
</dependency>
```

## Testing
Unit tests for all token operations

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-10 | 1.0 | Story created from Epic 0, Feature 0.5 | Bob (Scrum Master) |
