# Story 0.1.8: Location/Region Configuration Interface (Frontend)

## Status
Ready for development

## Story
**As an** Owner,
**I want** to configure my study hall's location (latitude, longitude, region) during onboarding,
**so that** students can discover my hall through regional search and Google Maps.

## Acceptance Criteria

### AC1: Location form displayed in onboarding wizard (Step 3)
**Given** owner has completed pricing configuration (Story 0.1.7)
**When** wizard advances to Step 3 (Location Configuration)
**Then** the system displays:
- Progress indicator: "Step 3 of 3: Location Configuration"
- Google Maps integration (map picker)
- Latitude and Longitude fields (auto-populated from map)
- Region dropdown (North Zone, South Zone, East Zone, West Zone, Central)
- "Complete Setup" button (activates hall, redirects to dashboard)
- "Skip for now" button (keeps DRAFT status)

### AC2: Google Maps integration for location picking
**Given** owner is on location configuration step
**When** owner clicks on map or searches address
**Then** the system:
- Updates map marker to selected location
- Auto-populates latitude and longitude fields
- Enables "Complete Setup" button

### AC3: Location saved via PUT /owner/halls/{hallId}/location
**Given** owner selects location and region
**When** owner clicks "Complete Setup"
**Then** the system:
- Validates latitude, longitude, region are set
- Sends PUT request to `/owner/halls/{hallId}/location`
- Updates hall status to ACTIVE
- Displays success: "Hall activated! Welcome to StudyMate"
- Redirects to owner dashboard

### AC4: Hall status changes to ACTIVE after location setup
**Given** owner completes location configuration
**When** location is saved successfully
**Then** the system:
- Sets hall status = ACTIVE (backend)
- Makes hall discoverable to students
- Enables all owner features (seat map, settings, etc.)

## Tasks / Subtasks

### Task 1: Create Location Configuration Component (AC: 1, 2, 3, 4)
- [ ] Create location step in wizard (Step 3)
- [ ] Integrate Google Maps API
- [ ] Add map picker UI element
- [ ] Add latitude/longitude input fields (readonly, auto-populated)
- [ ] Add region dropdown (5 options)
- [ ] Add data-testid attributes
- [ ] Implement "Complete Setup" and "Skip" buttons

### Task 2: Google Maps Integration (AC: 2)
- [ ] Install @angular/google-maps package
- [ ] Configure Google Maps API key in environment files
- [ ] Implement map click event to get lat/long
- [ ] Implement address search autocomplete
- [ ] Update marker position on map

### Task 3: Integrate Location API (AC: 3, 4)
- [ ] Create `updateHallLocation(hallId, location): Observable` in HallManagementService
- [ ] PUT to `/owner/halls/{hallId}/location`
- [ ] Handle success (200 OK, status=ACTIVE) - redirect to dashboard
- [ ] Handle errors (400, 404)
- [ ] Display loading spinner

### Task 4: Testing (AC: All)
- [ ] Unit tests: map integration, API calls
- [ ] E2E tests: location selection, hall activation
- [ ] Run 14 pre-commit validation commands

## Dev Notes

### API Endpoint
**PUT /owner/halls/{hallId}/location**
- Request: `{ "latitude": 19.0760, "longitude": 72.8777, "region": "WEST_ZONE" }`
- Response: `{ "hallId": "uuid", "latitude": 19.0760, "longitude": 72.8777, "region": "WEST_ZONE", "status": "ACTIVE", "updatedAt": "..." }`

### Google Maps API
- API Key required (obtain from Google Cloud Console)
- Store in environment.ts (dev) and environment.prod.ts (prod)
- Package: `@angular/google-maps`

### Region Options
- NORTH_ZONE (North Zone)
- SOUTH_ZONE (South Zone)
- EAST_ZONE (East Zone)
- WEST_ZONE (West Zone)
- CENTRAL (Central)

### File Locations
- Component: `src/app/features/owner/onboarding/location-step/location-step.component.ts`
- Tests: `e2e/owner-onboarding-wizard.spec.ts` (add location step tests)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-19 | 1.0 | Story created from Epic 0.1, Feature 0.1.8 | Sarah (PO) |

## Dev Agent Record
_To be filled by Dev Agent_

## QA Results
_To be filled by QA Agent_
