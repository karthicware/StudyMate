# Story 0.9: Configure Application Properties

## Status
Ready for Review

## Story
**As a** Developer,
**I want** application properties configured for all environments,
**so that** I can manage configuration for development, testing, and production separately.

## Acceptance Criteria
1. application.properties configured for all common settings
2. application-dev.properties created for local development
3. application-test.properties created for testing
4. application-prod.properties created for production
5. Environment-specific profiles working correctly
6. Sensitive properties externalized and documented

## Tasks / Subtasks
- [x] Task 1: Configure base application.properties (AC: 1)
  - [x] Set spring.application.name
  - [x] Configure server settings (port, context-path)
  - [x] Set active profile default to 'dev'
  - [x] Configure logging levels
  - [x] Add common JPA/Hibernate settings
- [x] Task 2: Create application-dev.properties (AC: 2)
  - [x] Set PostgreSQL database for local development
  - [x] Enable detailed SQL logging
  - [x] Disable security for easier development
  - [x] Enable Hibernate DDL auto-update
  - [x] Configure debug logging
- [x] Task 3: Create application-test.properties (AC: 3)
  - [x] Configure PostgreSQL database for tests
  - [x] Set ddl-auto to create-drop for tests
  - [x] Minimal logging for faster test execution
  - [x] Disable unnecessary features
- [x] Task 4: Create application-prod.properties (AC: 4)
  - [x] Use environment variables for sensitive data
  - [x] Enable production logging
  - [x] Disable SQL logging
  - [x] Set Hibernate to validate only
  - [x] Configure error handling
- [x] Task 5: Test profile activation (AC: 5)
  - [x] Run with -Dspring.profiles.active=dev
  - [x] Run with -Dspring.profiles.active=test
  - [x] Verify correct properties loaded
  - [x] Test environment variable substitution
- [x] Task 6: Document configuration (AC: 6)
  - [x] Create .env.example file
  - [x] Document all environment variables
  - [x] Add configuration guide to README
  - [x] Document profile usage

## Dev Notes

### Previous Story Insights
**From Stories 0.6-0.8:** Application properties exist but not fully configured for all environments

### Profile-based Configuration
[Source: docs/guidelines/coding-standard-guidelines/java-spring-rules.md]
- Use Spring Profiles for environment-specific config
- Default to 'dev' profile for local development
- Use environment variables for sensitive data in production

### Complete Configuration Files

**application.properties** (base):
```properties
spring.application.name=studymate-backend
server.port=8080
spring.profiles.active=dev

logging.level.root=INFO
logging.level.com.studymate.backend=INFO
```

**application-dev.properties**:
```properties
# Database - PostgreSQL for local development
spring.datasource.url=jdbc:postgresql://localhost:5432/studymate
spring.datasource.username=studymate_user
spring.datasource.password=studymate_user
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Security - Disabled for development
spring.security.enabled=false

# Logging - Verbose for development
logging.level.com.studymate.backend=DEBUG
logging.level.org.springframework.security=DEBUG
```

**application-test.properties**:
```properties
# Database - PostgreSQL for testing
spring.datasource.url=jdbc:postgresql://localhost:5432/studymate
spring.datasource.username=studymate_user
spring.datasource.password=studymate_user
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.hibernate.ddl-auto=create-drop
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Logging - Minimal for faster test execution
logging.level.root=WARN
logging.level.com.studymate.backend=INFO
```

**application-prod.properties**:
```properties
# Database - PostgreSQL from environment
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=false

# Security
spring.security.enabled=true
```

### File Locations
- `src/main/resources/application.properties`
- `src/main/resources/application-dev.properties`
- `src/main/resources/application-test.properties`
- `src/main/resources/application-prod.properties`
- `.env.example` (project root)

## Testing
- Test each profile loads correctly
- Verify environment variable substitution

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-10 | 1.0 | Story created from Epic 0, Feature 0.2 | Bob (Scrum Master) |
| 2025-10-11 | 1.1 | Corrected H2 references to PostgreSQL (aligned with Architecture mandate) | Sarah (Product Owner) |

## Dev Agent Record

### Agent Model Used
claude-sonnet-4-5-20250929

### Debug Log References
None

### Completion Notes
- All environment-specific profiles (dev, test, prod) configured and tested successfully
- Fixed StudymateBackendApplicationTests to use test profile instead of H2 (PostgreSQL mandate)
- All 14 tests passing
- Comprehensive profile documentation added to README.md with usage examples
- Environment variables properly externalized for production security

### File List
**Modified:**
- studymate-backend/src/main/resources/application.properties
- studymate-backend/src/main/resources/application-dev.properties
- studymate-backend/src/main/resources/application-test.properties
- studymate-backend/src/main/resources/application-prod.properties
- studymate-backend/src/test/java/com/studymate/backend/StudymateBackendApplicationTests.java
- studymate-backend/README.md
- .env.example

**Created:**
- None (all files already existed)

**Deleted:**
- None

### Change Log
- Updated application.properties with base configuration
- Verified application-dev.properties configuration for local development
- Verified application-test.properties configuration for testing
- Verified application-prod.properties configuration for production with env var substitution
- Fixed StudymateBackendApplicationTests to use @ActiveProfiles("test") instead of H2 configuration
- Updated README.md Configuration section with comprehensive profile documentation
- Verified .env.example contains all required environment variables
- All profiles tested and verified working correctly

## QA Results
_To be filled by QA Agent_
