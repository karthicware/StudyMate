# Story 0.10: Setup PostgreSQL Database Locally

## Status
Ready for development

## Story
**As a** Developer,
**I want** PostgreSQL database installed and configured locally,
**so that** I can develop and test backend services with a real database.

## Acceptance Criteria
1. PostgreSQL installed locally (native installation, not Docker)
2. Database `studymate_user` created
3. Database user `studymate_user` created with password `studymate_user`
4. Connection verified using psql command-line tool
5. Application connects to PostgreSQL successfully
6. PostgreSQL MCP server can connect to database

## Tasks / Subtasks
- [ ] Task 1: Install PostgreSQL (AC: 1)
  - [ ] Download PostgreSQL latest stable version for your OS
  - [ ] Run installer and follow setup wizard
  - [ ] Set postgres superuser password
  - [ ] Verify installation: `psql --version`
  - [ ] Start PostgreSQL service
- [ ] Task 2: Create database and user (AC: 2, 3)
  - [ ] Connect as postgres superuser: `psql -U postgres`
  - [ ] Create database: `CREATE DATABASE studymate_user;`
  - [ ] Create user: `CREATE USER studymate_user WITH PASSWORD 'studymate_user';`
  - [ ] Grant privileges: `GRANT ALL PRIVILEGES ON DATABASE studymate_user TO studymate_user;`
  - [ ] Verify: `\l` to list databases, `\du` to list users
- [ ] Task 3: Configure PostgreSQL connection (AC: 4)
  - [ ] Test connection: `psql -U studymate_user -d studymate_user`
  - [ ] Verify you can connect without errors
  - [ ] Exit psql: `\q`
- [ ] Task 4: Update application properties (AC: 5)
  - [ ] Uncomment database connection properties in application.properties
  - [ ] Set spring.datasource.url=jdbc:postgresql://localhost:5432/studymate_user
  - [ ] Set spring.datasource.username=studymate_user
  - [ ] Set spring.datasource.password=studymate_user
  - [ ] Set spring.datasource.driver-class-name=org.postgresql.Driver
- [ ] Task 5: Test application connection (AC: 5)
  - [ ] Run `mvn spring-boot:run`
  - [ ] Check logs for successful database connection
  - [ ] Verify no connection errors
  - [ ] Test health endpoint still works
- [ ] Task 6: Verify PostgreSQL MCP connection (AC: 6)
  - [ ] Use PostgreSQL MCP to connect to studymate_user database
  - [ ] Run test query: `SELECT version();`
  - [ ] Verify connection credentials work
  - [ ] Document MCP connection details
- [ ] Task 7: Create PostgreSQL installation guide (AC: 1)
  - [ ] Document installation steps for macOS
  - [ ] Document installation steps for Windows
  - [ ] Document installation steps for Linux
  - [ ] Add troubleshooting section
  - [ ] Add to README.md or separate docs/postgresql-setup.md

## Dev Notes

### Previous Story Insights
**From Stories 0.6-0.9:** Backend scaffolding complete, but database connection commented out

### PostgreSQL Installation
[Source: docs/epics/epic-0-project-foundation-setup.md#database]
- **Database**: PostgreSQL latest stable
- **Installation**: Native (no Docker)
- **Credentials**: DB=`studymate_user`, user=`studymate_user`, pwd=`studymate_user`

### PostgreSQL Setup Commands
```sql
-- Connect as postgres superuser
psql -U postgres

-- Create database
CREATE DATABASE studymate_user;

-- Create user with password
CREATE USER studymate_user WITH PASSWORD 'studymate_user';

-- Grant all privileges
GRANT ALL PRIVILEGES ON DATABASE studymate_user TO studymate_user;

-- Connect to the new database
\c studymate_user

-- Grant schema privileges (PostgreSQL 15+)
GRANT ALL ON SCHEMA public TO studymate_user;

-- Exit
\q
```

### Application Properties Update
```properties
# Database Configuration
spring.datasource.url=jdbc:postgresql://localhost:5432/studymate_user
spring.datasource.username=studymate_user
spring.datasource.password=studymate_user
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA/Hibernate
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
```

### PostgreSQL MCP Connection
[Source: docs/architecture/studymate-system-architecture-blueprint.md#7-postgresql-mcp-integration-mandatory]
- **Database Name**: studymate_user
- **Username**: studymate_user
- **Password**: studymate_user
- **Host**: localhost
- **Port**: 5432

### File Locations
- Application properties: `src/main/resources/application.properties`
- Installation guide: `docs/postgresql-setup.md` or Story 0.18

## Testing
- **psql Connection**: Connect using command line
- **Application Connection**: Spring Boot connects successfully
- **MCP Connection**: PostgreSQL MCP can query database

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-10 | 1.0 | Story created from Epic 0, Feature 0.3 | Bob (Scrum Master) |

## Dev Agent Record
_To be filled by Dev Agent_

## QA Results
_To be filled by QA Agent_
