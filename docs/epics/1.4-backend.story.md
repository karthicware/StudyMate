# Story 1.4-Backend: Implement Seat Configuration API

## Status
Draft

## Story
**As a** Backend Developer,
**I want** seat configuration API endpoint implemented,
**so that** owners can create and update seat maps for their halls.

## Acceptance Criteria
1. POST `/owner/seats/config/{hallId}` endpoint created
2. Bulk seat creation/update supported (create multiple seats in one request)
3. Seat coordinates validated (x, y within hall dimensions)
4. Duplicate seat numbers prevented per hall
5. Owner authorization enforced
6. PostgreSQL MCP validation completed

## Tasks / Subtasks
- [ ] Create SeatConfigController with POST endpoint
- [ ] Create SeatConfigService for business logic
- [ ] Create SeatConfigRequest DTO (array of seats)
- [ ] Implement validation (coordinates, duplicates)
- [ ] Verify hall ownership
- [ ] Use @Transactional for bulk operations
- [ ] Create unit and integration tests
- [ ] Validate with PostgreSQL MCP

## Dev Notes

### API Specification
**Endpoint:** `POST /owner/seats/config/{hallId}`

**Request Body:**
```json
{
  "seats": [
    {"seatNumber": "A1", "xCoord": 10, "yCoord": 20},
    {"seatNumber": "A2", "xCoord": 10, "yCoord": 40}
  ]
}
```

**Response:** 201 Created with created seat IDs

### Implementation Highlights
```java
@PostMapping("/{hallId}")
@PreAuthorize("hasRole('OWNER')")
@Transactional
public ResponseEntity<SeatConfigResponse> configureSeatMap(
        @PathVariable Long hallId,
        @Valid @RequestBody SeatConfigRequest request,
        @AuthenticationPrincipal UserDetails userDetails) {

    SeatConfigResponse response = seatConfigService.configureSeats(hallId, request, userDetails);
    return ResponseEntity.status(HttpStatus.CREATED).body(response);
}
```

### Validation Rules
- Seat numbers must be unique within hall
- Coordinates must be positive integers
- Maximum 500 seats per hall
- Upsert logic: Update if seat exists, create if new

### File Locations
- Controller: `controller/SeatConfigController.java`
- Service: `service/SeatConfigService.java`
- DTOs: `dto/SeatConfigRequest.java`, `dto/SeatConfigResponse.java`

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-10 | 1.0 | Seat config API backend story | Bob (Scrum Master) |
